import requests
import json
import cv2
import urllib2

def main():

    url = "https://ic-media-service.run.aws-usw02-pr.ice.predix.io/v2/mediastore/ondemand/assets/CAM-ATL-0011-1/media"

    querystring = {"mediaType":"VIDEO","timestamp":"1509639132000"}

    headers = {
        'authorization': "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6ImxlZ2FjeS10b2tlbi1rZXkiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiI4OTU5M2I0YTM5MmY0ZWE4YjJhNjU0ODBlZWRlOTIwZSIsInN1YiI6ImhhY2thdGhvbiIsInNjb3BlIjpbInVhYS5yZXNvdXJjZSIsImllLWN1cnJlbnQuU0RTSU0tSUUtUFVCTElDLVNBRkVUWS5JRS1QVUJMSUMtU0FGRVRZLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtRU5WSVJPTk1FTlRBTC5JRS1FTlZJUk9OTUVOVEFMLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtVFJBRkZJQy5JRS1UUkFGRklDLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtUEFSS0lORy5JRS1QQVJLSU5HLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtUEVERVNUUklBTi5JRS1QRURFU1RSSUFOLkxJTUlURUQuREVWRUxPUCJdLCJjbGllbnRfaWQiOiJoYWNrYXRob24iLCJjaWQiOiJoYWNrYXRob24iLCJhenAiOiJoYWNrYXRob24iLCJncmFudF90eXBlIjoiY2xpZW50X2NyZWRlbnRpYWxzIiwicmV2X3NpZyI6IjlmMWYyYzRkIiwiaWF0IjoxNTA5NzY0NzcxLCJleHAiOjE1MTAzNjk1NzEsImlzcyI6Imh0dHBzOi8vODkwNDA3ZDctZTYxNy00ZDcwLTk4NWYtMDE3OTJkNjkzMzg3LnByZWRpeC11YWEucnVuLmF3cy11c3cwMi1wci5pY2UucHJlZGl4LmlvL29hdXRoL3Rva2VuIiwiemlkIjoiODkwNDA3ZDctZTYxNy00ZDcwLTk4NWYtMDE3OTJkNjkzMzg3IiwiYXVkIjpbImllLWN1cnJlbnQuU0RTSU0tSUUtVFJBRkZJQy5JRS1UUkFGRklDLkxJTUlURUQiLCJpZS1jdXJyZW50LlNEU0lNLUlFLVBBUktJTkcuSUUtUEFSS0lORy5MSU1JVEVEIiwiaWUtY3VycmVudC5TRFNJTS1JRS1QVUJMSUMtU0FGRVRZLklFLVBVQkxJQy1TQUZFVFkuTElNSVRFRCIsInVhYSIsImhhY2thdGhvbiIsImllLWN1cnJlbnQuU0RTSU0tSUUtRU5WSVJPTk1FTlRBTC5JRS1FTlZJUk9OTUVOVEFMLkxJTUlURUQiLCJpZS1jdXJyZW50LlNEU0lNLUlFLVBFREVTVFJJQU4uSUUtUEVERVNUUklBTi5MSU1JVEVEIl19.umb3jGBd9aWQ7vSWq9CtcQodQLg0Sa-GsR6qPdPLc1qW55tdG6aTbqbmqy3X4ITMZdP8ilpNVsrRtpR9O5NWnnoICVkT-9JsHePULyMUKcKN5DKlcvlAJB1brrLTv3aOGl6BcVXOO4Jr6qp8Rzop3Dp9qgWJe0FoknI36eWjLdP5AcKG6oPwPXaxBiDRpvlb108JFjVbCRKMNbLOudOmgkzeFgCwSd5f4Seyg-AqVmAlFR9rxgjiKNBw5OxQhiIS3cVsvZqXteIcs5_RQom6wCDWqIiSuUx0-1DSGT16nJtueCDQGbsEjgX8wJ7yHCvL2Dnq9U-zmJnsSxmZF98WIg",
        'predix-zone-id': "SDSIM-IE-PUBLIC-SAFETY",
        'cache-control': "no-cache",
        'postman-token': "aa8104aa-1a91-4c9d-966f-83fd38e6846e"
        }

    response = requests.request("GET", url, headers=headers, params=querystring)

    print(response.text)


    url = "https://ic-media-service.run.aws-usw02-pr.ice.predix.io/v2/mediastore/ondemand/getMedia/f76116e1-56b5-45c7-bf07-fc0e043baab3"

    querystring = {"page":"0","size":"100","sortBy":"mediaLogId","sortDir":"ASC"}

    headers = {
        'authorization': "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6ImxlZ2FjeS10b2tlbi1rZXkiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiI4OTU5M2I0YTM5MmY0ZWE4YjJhNjU0ODBlZWRlOTIwZSIsInN1YiI6ImhhY2thdGhvbiIsInNjb3BlIjpbInVhYS5yZXNvdXJjZSIsImllLWN1cnJlbnQuU0RTSU0tSUUtUFVCTElDLVNBRkVUWS5JRS1QVUJMSUMtU0FGRVRZLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtRU5WSVJPTk1FTlRBTC5JRS1FTlZJUk9OTUVOVEFMLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtVFJBRkZJQy5JRS1UUkFGRklDLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtUEFSS0lORy5JRS1QQVJLSU5HLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtUEVERVNUUklBTi5JRS1QRURFU1RSSUFOLkxJTUlURUQuREVWRUxPUCJdLCJjbGllbnRfaWQiOiJoYWNrYXRob24iLCJjaWQiOiJoYWNrYXRob24iLCJhenAiOiJoYWNrYXRob24iLCJncmFudF90eXBlIjoiY2xpZW50X2NyZWRlbnRpYWxzIiwicmV2X3NpZyI6IjlmMWYyYzRkIiwiaWF0IjoxNTA5NzY0NzcxLCJleHAiOjE1MTAzNjk1NzEsImlzcyI6Imh0dHBzOi8vODkwNDA3ZDctZTYxNy00ZDcwLTk4NWYtMDE3OTJkNjkzMzg3LnByZWRpeC11YWEucnVuLmF3cy11c3cwMi1wci5pY2UucHJlZGl4LmlvL29hdXRoL3Rva2VuIiwiemlkIjoiODkwNDA3ZDctZTYxNy00ZDcwLTk4NWYtMDE3OTJkNjkzMzg3IiwiYXVkIjpbImllLWN1cnJlbnQuU0RTSU0tSUUtVFJBRkZJQy5JRS1UUkFGRklDLkxJTUlURUQiLCJpZS1jdXJyZW50LlNEU0lNLUlFLVBBUktJTkcuSUUtUEFSS0lORy5MSU1JVEVEIiwiaWUtY3VycmVudC5TRFNJTS1JRS1QVUJMSUMtU0FGRVRZLklFLVBVQkxJQy1TQUZFVFkuTElNSVRFRCIsInVhYSIsImhhY2thdGhvbiIsImllLWN1cnJlbnQuU0RTSU0tSUUtRU5WSVJPTk1FTlRBTC5JRS1FTlZJUk9OTUVOVEFMLkxJTUlURUQiLCJpZS1jdXJyZW50LlNEU0lNLUlFLVBFREVTVFJJQU4uSUUtUEVERVNUUklBTi5MSU1JVEVEIl19.umb3jGBd9aWQ7vSWq9CtcQodQLg0Sa-GsR6qPdPLc1qW55tdG6aTbqbmqy3X4ITMZdP8ilpNVsrRtpR9O5NWnnoICVkT-9JsHePULyMUKcKN5DKlcvlAJB1brrLTv3aOGl6BcVXOO4Jr6qp8Rzop3Dp9qgWJe0FoknI36eWjLdP5AcKG6oPwPXaxBiDRpvlb108JFjVbCRKMNbLOudOmgkzeFgCwSd5f4Seyg-AqVmAlFR9rxgjiKNBw5OxQhiIS3cVsvZqXteIcs5_RQom6wCDWqIiSuUx0-1DSGT16nJtueCDQGbsEjgX8wJ7yHCvL2Dnq9U-zmJnsSxmZF98WIg",
        'predix-zone-id': "SDSIM-IE-PUBLIC-SAFETY",
        'cache-control': "no-cache",
        'postman-token': "d9a91201-6952-b117-078a-a7224d098b81"
        }

    response = requests.request("GET", url, headers=headers, params=querystring)

    print(response.text)

    url = "https://ic-media-service.run.aws-usw02-pr.ice.predix.io/v2/mediastore/file/CAM-ATL-0011-1_1509639132000_10_VIDEO_mp4"

    headers = {
        'authorization': "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6ImxlZ2FjeS10b2tlbi1rZXkiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiI4OTU5M2I0YTM5MmY0ZWE4YjJhNjU0ODBlZWRlOTIwZSIsInN1YiI6ImhhY2thdGhvbiIsInNjb3BlIjpbInVhYS5yZXNvdXJjZSIsImllLWN1cnJlbnQuU0RTSU0tSUUtUFVCTElDLVNBRkVUWS5JRS1QVUJMSUMtU0FGRVRZLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtRU5WSVJPTk1FTlRBTC5JRS1FTlZJUk9OTUVOVEFMLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtVFJBRkZJQy5JRS1UUkFGRklDLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtUEFSS0lORy5JRS1QQVJLSU5HLkxJTUlURUQuREVWRUxPUCIsImllLWN1cnJlbnQuU0RTSU0tSUUtUEVERVNUUklBTi5JRS1QRURFU1RSSUFOLkxJTUlURUQuREVWRUxPUCJdLCJjbGllbnRfaWQiOiJoYWNrYXRob24iLCJjaWQiOiJoYWNrYXRob24iLCJhenAiOiJoYWNrYXRob24iLCJncmFudF90eXBlIjoiY2xpZW50X2NyZWRlbnRpYWxzIiwicmV2X3NpZyI6IjlmMWYyYzRkIiwiaWF0IjoxNTA5NzY0NzcxLCJleHAiOjE1MTAzNjk1NzEsImlzcyI6Imh0dHBzOi8vODkwNDA3ZDctZTYxNy00ZDcwLTk4NWYtMDE3OTJkNjkzMzg3LnByZWRpeC11YWEucnVuLmF3cy11c3cwMi1wci5pY2UucHJlZGl4LmlvL29hdXRoL3Rva2VuIiwiemlkIjoiODkwNDA3ZDctZTYxNy00ZDcwLTk4NWYtMDE3OTJkNjkzMzg3IiwiYXVkIjpbImllLWN1cnJlbnQuU0RTSU0tSUUtVFJBRkZJQy5JRS1UUkFGRklDLkxJTUlURUQiLCJpZS1jdXJyZW50LlNEU0lNLUlFLVBBUktJTkcuSUUtUEFSS0lORy5MSU1JVEVEIiwiaWUtY3VycmVudC5TRFNJTS1JRS1QVUJMSUMtU0FGRVRZLklFLVBVQkxJQy1TQUZFVFkuTElNSVRFRCIsInVhYSIsImhhY2thdGhvbiIsImllLWN1cnJlbnQuU0RTSU0tSUUtRU5WSVJPTk1FTlRBTC5JRS1FTlZJUk9OTUVOVEFMLkxJTUlURUQiLCJpZS1jdXJyZW50LlNEU0lNLUlFLVBFREVTVFJJQU4uSUUtUEVERVNUUklBTi5MSU1JVEVEIl19.umb3jGBd9aWQ7vSWq9CtcQodQLg0Sa-GsR6qPdPLc1qW55tdG6aTbqbmqy3X4ITMZdP8ilpNVsrRtpR9O5NWnnoICVkT-9JsHePULyMUKcKN5DKlcvlAJB1brrLTv3aOGl6BcVXOO4Jr6qp8Rzop3Dp9qgWJe0FoknI36eWjLdP5AcKG6oPwPXaxBiDRpvlb108JFjVbCRKMNbLOudOmgkzeFgCwSd5f4Seyg-AqVmAlFR9rxgjiKNBw5OxQhiIS3cVsvZqXteIcs5_RQom6wCDWqIiSuUx0-1DSGT16nJtueCDQGbsEjgX8wJ7yHCvL2Dnq9U-zmJnsSxmZF98WIg",
        'predix-zone-id': "SDSIM-IE-PUBLIC-SAFETY",
        'cache-control': "no-cache",
        'postman-token': "09660f3a-2157-2ead-42fe-d95299961495"
        }

    response = requests.request("GET", url, headers=headers, stream=True)
    handle = open("test222.mp4", "wb")
    for chunk in response.iter_content(chunk_size=512):
        if chunk:  # filter out keep-alive new chunks
            handle.write(chunk)

main()
#